<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
  <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>
  <link rel="stylesheet" href="css/style.css">
</head>

<div id="root"></div>

<script type="text/babel">

const digits = [
  {
    value: "one",
    symbol: 1
  },
  {
    value: "two",
    symbol: "2"
  },
  {
    value: "three",
    symbol: "3"
  },
  {
    value: "four",
    symbol: "4"
  },
  {
    value: "five",
    symbol: "5"
  },
  {
    value: "six",
    symbol: "6"
  },
  {
    value: "seven",
    symbol: "7"
  },
  {
    value: "eight",
    symbol: "8"
  },
  {
    value: "nine",
    symbol: "9"
  },
  {
    value: "zero",
    symbol: "0"
  },
  {
    value: "decimal",
    symbol: "."
  }
  ];
const operations = [
  {
    op: "add",
    symbol: "+"
  },
  {
    op: "subtract",
    symbol: "-"
  },
  {
    op: "multiply",
    symbol: "*"
  },
  {
    op: "divide",
    symbol: "/"
  },
  {
    op: "equals",
    symbol:"="
  },
  {
    op: "clear",
    symbol: "CLR"
  }
];

class NumberPad extends React.Component{
  constructor(props){
    super(props);
    this.handleNumClick = this.handleNumClick.bind(this);
  }

  handleNumClick(event){
    this.props.updateEq(event.target.value);
  }

  render(){
    const pad = digits.map(function(digit){
      return(
        <button className="padButton" id={digit.value} key={digit.value} onClick={this.handleNumClick} value={digit.symbol}>{digit.symbol}</button>
      )
    },this);

    return(
      <div id="numberPad">
        {pad}
      </div>
    )
  }
}

class OperationPad extends React.Component{
  constructor(props){
    super(props);
    this.handleOpClick=this.handleOpClick.bind(this);
  }

  handleOpClick(event){
    this.props.updateEq(event.target.value);
  }

  render(){
    const pad = operations.map(function(operation){
      return(
        <button className="padButton" id={operation.op} key={operation.op} onClick={this.handleOpClick} value= {operation.symbol}>{operation.symbol}</button>
      )
    },this);

    return(
      <div id="operationPad">
        {pad}
      </div>
    )
  }
}

class Root extends React.Component{
  constructor(props){
    super(props)
    this.state={
      value: 0,
      decimalActive: false,
      equation:[],
      display: "Display"
    }
    this.updateEquation = this.updateEquation.bind(this);
  }

  updateEquation(val){
    var newEquation = [];
    if (digits.some(digit => digit['symbol'] == val)){
      if(this.state.equation.length == 0){
        if (val == "."){
          this.setState({equation: ["."], decimalActive: true})
        } else {
          this.setState({equation: [val]})
        }
      } else {
        if ((val == "." && this.state.decimalActive == false) || val != "."){
          if (val =="."){
            this.setState({decimalActive: true});
          }
          newEquation = [...this.state.equation];
          newEquation[newEquation.length - 1] = newEquation[newEquation.length - 1] + val;
          this.setState({equation: newEquation});
        }
      }
    }
    if (operations.some(operation => operation['symbol'] == val)){
      if(val == 'CLR'){
        //reset state
        this.setState({value: 0, decimalActive: false, equation:[], display:"Display"})
      } else {
        newEquation = [...this.state.equation,val,""];
        this.setState({equation: newEquation, decimalActive: false});
      }
    }
  }

  render(){
    console.log(this.state.equation)
    return (
      <div id="calculator">
        <div id="display">{this.state.display}</div>
        <div id="pad">
          <NumberPad updateEq={this.updateEquation}/>
          <OperationPad updateEq={this.updateEquation}/>
        </div>
      </div>
    )
  }
}

ReactDOM.render(<Root />, document.getElementById('root'))

//logic in words?
/*
  put all ops and numbers into an array.
  format array into proper format i.e..
  see clr or = means evaluate
  see decimal(.) means combine natural numbers to form a real one.

*/
</script>

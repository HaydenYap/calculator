<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
  <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>
  <link rel="stylesheet" href="css/style.css">
</head>

<div id="app"></div>

<script type="text/babel">

  const digits = [
    {
      value: "one",
      symbol: 1
    },
    {
      value: "two",
      symbol: 2
    },
    {
      value: "three",
      symbol: 3
    },
    {
      value: "four",
      symbol: 4
    },
    {
      value: "five",
      symbol: 5
    },
    {
      value: "six",
      symbol: 6
    },
    {
      value: "seven",
      symbol: 7
    },
    {
      value: "eight",
      symbol: 8
    },
    {
      value: "nine",
      symbol: 9
    },
    {
      value: "zero",
      symbol: 0
    }
    ];
  const operations = [
    {
      op: "add",
      symbol: "+"
    },
    {
      op: "subtract",
      symbol: "-"
    },
    {
      op: "multiply",
      symbol: "*"
    },
    {
      op: "divide",
      symbol: "/"
    },
    {
      op: "equals",
      symbol:"="
    },
    {
      op: "decimal",
      symbol: "."
    },
    {
      op: "clear",
      symbol: "CLR"
    }
  ];

  class NumberPad extends React.Component{
    constructor(props){
      super(props);
      this.handleNumClick = this.handleNumClick.bind(this);
    }

    handleNumClick(event){
      this.props.updateEq(event.target.value);
    }

    render(){
      const pad = digits.map(function(digit){
        return(
          <button className="padButton" id={digit.value} key={digit.value} onClick={this.handleNumClick} value={digit.symbol}>{digit.symbol}</button>
        )
      },this);

      return(
        <div id="numberPad">
          {pad}
        </div>
      )
    }
  }

  class OperationPad extends React.Component{
    constructor(props){
      super(props);
      this.handleOpClick=this.handleOpClick.bind(this);
    }

    handleOpClick(event){
      this.props.updateEq(event.target.value)
    }

    render(){
      const pad = operations.map(function(operation){
        return(
          <button className="padButton" id={operation.op} key={operation.op} onClick={this.handleOpClick} value= {operation.symbol}>{operation.symbol}</button>
        )
      },this);

      return(
        <div id="operationPad">
          {pad}
        </div>
      )
    }
  }

  class App extends React.Component{
    constructor(props){
      super(props)
      this.state={
        value: 0,
        decimalMode: false,
        equation:[],
        display: "Display"
      }
      this.updateEquation = this.updateEquation.bind(this);
    }

    updateEquation(val){
      var newEquation;
      if(val == "CLR"){
        this.setState({equation: [],decimalMode: false});
      } else if (val == "."){
          if (this.state.decimalMode == true){
            console.log("error double decimal");
          } else {
            this.setState({decimalMode: true});
            console.log("In decimal Mode")
            // concatenate decimal with previous
          }
      } else if (this.state.decimalMode == true){
          if (this.state.equation.length == 0){
            newEquation = ["0."];
            this.setState({equation: newEquation})
          } else {
            newEquation = [...this.state.equation];
            newEquation[newEquation.length - 1 ] = newEquation[newEquation.length-1] + val;
            this.setState({equation: newEquation})
          }
      } else {
        newEquation = [...this.state.equation, val];
        this.setState({equation: newEquation});
      }





      /*else{
        if (val == "." || this.state.decimalMode == true){
          this.setState({decimalMode: true})
          newEquation = [...this.state.equation];
          newEquation[newEquation.length - 1 ] = newEquation[newEquation.length-1] + val;
          this.setState({equation: newEquation})
        } else if (this.state.decimalMode == true && val != /[\d]/){
          this.setState({decimalMode: false})
        } else {
          newEquation = [...this.state.equation, val];
          this.setState({equation: newEquation});
        }
      }*/
    }

    render(){
      console.log(this.state.equation);
      return (
        <div id="calculator">
          <div id="display">{this.state.display}</div>
          <div id="pad">
            <NumberPad updateEq={this.updateEquation}/>
            <OperationPad updateEq={this.updateEquation}/>
          </div>
        </div>
      )
    }
  }

  ReactDOM.render(<App />, document.getElementById('app'))

  //logic in words?
  /*
    put all ops and numbers into an array.
    format array into proper format i.e..
    see clr or = means evaluate
    see decimal(.) means combine natural numbers to form a real one.

  */
</script>
